# 🧠 `<Routes>` in React Router

## 📌 요약 정의

`<Routes>`는 React Router v6 이상에서 사용하는 라우트 **매칭 트리 컨테이너**입니다. 내부의 `<Route>` 요소들을 순회하며 현재 `location.pathname`과 일치하는 경로를 찾아 적절한 컴포넌트를 렌더링합니다.

```jsx
<Routes>
  <Route path="/" element={<Home />} />
  <Route path="/about" element={<About />} />
</Routes>
```

---

## 🔄 동작 원리

### 1. 경로 매칭 알고리즘

* `<Routes>`는 내부적으로 **트리 기반 정렬 및 최적화된 매칭 알고리즘**을 사용합니다.
* 더 이상 **상단부터 순차적으로 매칭하는 방식이 아닙니다** (v5의 `<Switch>`와 다름).
* 모든 `<Route>`를 사전 정렬하여 가장 구체적인 경로(예: `/users/:id/details`)가 먼저 매칭됩니다.

### 2. `useRoutes`와 동일한 역할

* `<Routes>`는 선언형 API이며,
* `useRoutes()`는 동일한 기능의 함수형 API입니다.

```jsx
// 함수형 선언 방식
const routing = useRoutes([
  { path: '/', element: <Home /> },
  { path: '/about', element: <About /> }
]);
```

---

## 🧱 주요 특징 및 기능

### ✅ 1. 중첩 라우팅을 기본 지원

`<Routes>` 내부에서 `<Route>`는 중첩될 수 있고, 이는 부모 컴포넌트의 `<Outlet />`을 통해 자식 컴포넌트를 렌더링합니다.

```jsx
<Routes>
  <Route path="/dashboard" element={<Dashboard />}>
    <Route path="profile" element={<Profile />} />
    <Route path="settings" element={<Settings />} />
  </Route>
</Routes>
```

```jsx
// Dashboard.jsx
return (
  <div>
    <h2>Dashboard</h2>
    <Outlet /> {/* 여기에 Profile 또는 Settings가 렌더링됨 */}
  </div>
);
```

### ✅ 2. `element` 속성 필수

* `element`는 컴포넌트 인스턴스를 전달해야 하며 **JSX 형태로** 작성합니다.
* `component`나 `render`는 더 이상 사용되지 않습니다 (v5에서 제거됨).

### ✅ 3. 정적/동적 라우팅 모두 가능

```jsx
<Route path="/products/:productId" element={<ProductDetail />} />
```

* `useParams()`로 `productId` 접근 가능.

---

## ⚠️ 자주 혼동하는 개념

| 개념                       | 설명                                       |
| ------------------------ | ---------------------------------------- |
| `<Switch>`               | v5에서 사용하던 컴포넌트. **첫 매칭만 렌더링**. v6에서 제거됨. |
| `<Routes>`               | v6부터 도입. **트리 기반 매칭**, 중첩 경로 자동 처리.      |
| `element` vs `component` | v6에서는 **element만 사용**, JSX 요소로 전달해야 함.   |

---

## 🛠️ 고급 기능

### 1. `index` 라우트

* 부모 경로의 기본 컴포넌트 정의에 사용.

```jsx
<Route path="/dashboard" element={<Dashboard />}>
  <Route index element={<DashboardHome />} />
</Route>
```

### 2. Catch-all (404 Not Found)

```jsx
<Route path="*" element={<NotFound />} />
```

### 3. 라우트 경로 없이 `<Outlet>`만 쓰는 중간 Wrapper

```jsx
<Route element={<AuthLayout />}>
  <Route path="/admin" element={<AdminDashboard />} />
</Route>
```

---

## ⚙️ 내부 구현 흐름 (간단히)

1. `<Routes>`는 현재 `location.pathname`을 기준으로 모든 `<Route>` 트리를 탐색합니다.
2. 정렬된 경로 목록에서 가장 구체적인 매칭을 찾습니다.
3. 매칭된 경로의 `element`를 렌더링합니다.
4. 중첩된 경우, 상위 `<Route>`의 `element` 내부 `<Outlet />`에 자식 경로 요소를 주입합니다.

---

## 🧪 예제: 중첩 라우팅 + 404 처리

```jsx
<Routes>
  <Route path="/" element={<Layout />}>
    <Route index element={<Home />} />
    <Route path="about" element={<About />} />
    <Route path="users/:id" element={<UserDetail />} />
    <Route path="*" element={<NotFound />} />
  </Route>
</Routes>
```

```jsx
// Layout.jsx
return (
  <>
    <Header />
    <Outlet />
    <Footer />
  </>
);
```

---

## ✅ 요약 정리

| 항목        | 설명                                           |
| --------- | -------------------------------------------- |
| 기능        | 경로 트리 매칭 및 적절한 컴포넌트 렌더링                      |
| v5 대비 개선점 | `Switch` → `Routes`, `component` → `element` |
| 중첩 라우팅    | 기본 지원 (`Outlet` 사용)                          |
| index 라우팅 | 부모의 기본 자식 라우트 지정 가능                          |
| 동적 파라미터   | `:id`, `:slug` 등으로 정의, `useParams`로 사용       |
| 예외 처리     | `path="*"`로 fallback 라우트 정의                  |

---

## 📌 정리

* `<Routes>`는 React Router v6의 **라우팅 트리 핵심**으로, 이전 버전의 `<Switch>`보다 훨씬 강력하고 선언적입니다.
* `Route` 간의 중첩 및 트리 구조를 통해 실제 앱 구조를 표현하고, `Outlet`을 통해 컴포넌트 계층을 연결합니다.
* `element`, `index`, `path`, `*` 같은 속성들을 조합하여 매우 유연한 라우팅 구성이 가능합니다.


